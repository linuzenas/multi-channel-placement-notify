{% extends "base.html" %}

{% block title %}Create Message - Admin{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-header">
                    <h3 class="mb-0">
                        <i class="fas fa-plus me-2"></i>Create New Placement Message
                    </h3>
                    <p class="mb-0 mt-2 text-muted">Fill in the details to create a new placement opportunity message</p>
                </div>
                <div class="card-body p-5">
                    <form method="POST" id="messageForm">
                        <div class="row g-3">
                            <!-- Basic Information -->
                            <div class="col-12">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-info-circle me-2"></i>Basic Information
                                </h5>
                            </div>
                            
                            <div class="col-12">
                                <label for="title" class="form-label">Message Title *</label>
                                <input type="text" class="form-control" id="title" name="title" 
                                       placeholder="e.g., Hire3x!! Campus Drive for 2026 Batch" required>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="company_name" class="form-label">Company Name *</label>
                                <input type="text" class="form-control" id="company_name" name="company_name" 
                                       placeholder="e.g., Hire3x!!" required>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="job_title" class="form-label">Job Title *</label>
                                <input type="text" class="form-control" id="job_title" name="job_title" 
                                       placeholder="e.g., Graduate Trainee â€“ Developer" required>
                            </div>
                            
                            <!-- Compensation Details -->
                            <div class="col-12 mt-4">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-money-bill-wave me-2"></i>Compensation Details
                                </h5>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="ctc_ug" class="form-label">CTC for UG Students</label>
                                <input type="text" class="form-control" id="ctc_ug" name="ctc_ug" 
                                       placeholder="e.g., 3.5 to 5 LPA based on performance">
                            </div>
                            
                            <div class="col-md-6">
                                <label for="ctc_pg" class="form-label">CTC for PG Students</label>
                                <input type="text" class="form-control" id="ctc_pg" name="ctc_pg" 
                                       placeholder="e.g., 4.5 to 6 LPA based on performance">
                            </div>
                            
                            <div class="col-12">
                                <label for="stipend" class="form-label">Stipend Details</label>
                                <input type="text" class="form-control" id="stipend" name="stipend" 
                                       placeholder="e.g., Rs. 15k/- Per month during training">
                            </div>
                            
                            <!-- Eligibility & Requirements -->
                            <div class="col-12 mt-4">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-clipboard-check me-2"></i>Eligibility & Requirements
                                </h5>
                            </div>
                            
                            <div class="col-12">
                                <label for="eligibility" class="form-label">Eligibility Criteria</label>
                                <textarea class="form-control" id="eligibility" name="eligibility" rows="4" 
                                          placeholder="e.g., Unplaced Students with no standing arrear are eligible."></textarea>
                            </div>
                            
                            <!-- Registration & Links -->
                            <div class="col-12 mt-4">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-link me-2"></i>Registration & Links
                                </h5>
                            </div>
                            
                            <div class="col-12">
                                <label for="registration_link" class="form-label">Registration Link</label>
                                <input type="url" class="form-control" id="registration_link" name="registration_link" 
                                       placeholder="https://example.com/registration">
                            </div>
                            
                            <!-- Additional Information -->
                            <div class="col-12 mt-4">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-sticky-note me-2"></i>Additional Information
                                </h5>
                            </div>
                            
                            <div class="col-12">
                                <label for="additional_notes" class="form-label">Additional Notes</label>
                                <textarea class="form-control" id="additional_notes" name="additional_notes" rows="4" 
                                          placeholder="Any additional information, instructions, or notes for students..."></textarea>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between mt-5">
                            <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
                            </a>
                            <div>
                                <button type="button" class="btn btn-outline-primary me-2" onclick="previewMessage()">
                                    <i class="fas fa-eye me-2"></i>Preview
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save me-2"></i>Create Message
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Preview Card -->
            <div class="card border-0 bg-light mt-4" id="previewCard" style="display: none;">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="fas fa-eye me-2"></i>Message Preview
                    </h5>
                    <div id="previewContent"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Preview Modal -->
<div class="modal fade" id="previewModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-eye me-2"></i>Message Preview
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="modalPreviewContent"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="submitForm()">Create Message</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function previewMessage() {
        const form = document.getElementById('messageForm');
        const formData = new FormData(form);
        
        const title = formData.get('title') || 'Message Title';
        const company = formData.get('company_name') || 'Company Name';
        const jobTitle = formData.get('job_title') || 'Job Title';
        const ctcUg = formData.get('ctc_ug') || '';
        const ctcPg = formData.get('ctc_pg') || '';
        const stipend = formData.get('stipend') || '';
        const eligibility = formData.get('eligibility') || '';
        const registrationLink = formData.get('registration_link') || '';
        const additionalNotes = formData.get('additional_notes') || '';
        
        let previewHtml = `
            <div class="border rounded p-4 bg-white">
                <h4 class="text-primary mb-3">${title}</h4>
                <div class="row g-3">
                    <div class="col-md-6">
                        <strong>Company:</strong> ${company}
                    </div>
                    <div class="col-md-6">
                        <strong>Job Title:</strong> ${jobTitle}
                    </div>
                    ${ctcUg ? `<div class="col-md-6"><strong>UG CTC:</strong> ${ctcUg}</div>` : ''}
                    ${ctcPg ? `<div class="col-md-6"><strong>PG CTC:</strong> ${ctcPg}</div>` : ''}
                    ${stipend ? `<div class="col-12"><strong>Stipend:</strong> ${stipend}</div>` : ''}
                    ${eligibility ? `<div class="col-12"><strong>Eligibility:</strong><br>${eligibility}</div>` : ''}
                    ${registrationLink ? `<div class="col-12"><strong>Registration Link:</strong><br><a href="${registrationLink}" target="_blank">${registrationLink}</a></div>` : ''}
                    ${additionalNotes ? `<div class="col-12"><strong>Additional Notes:</strong><br>${additionalNotes}</div>` : ''}
                </div>
            </div>
        `;
        
        document.getElementById('previewContent').innerHTML = previewHtml;
        document.getElementById('previewCard').style.display = 'block';
        
        // Also show in modal
        document.getElementById('modalPreviewContent').innerHTML = previewHtml;
        new bootstrap.Modal(document.getElementById('previewModal')).show();
    }
    
    function submitForm() {
        document.getElementById('messageForm').submit();
    }
</script>
{% endblock %}